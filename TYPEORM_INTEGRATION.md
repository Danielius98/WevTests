# TypeORM Integration

Этот проект теперь использует TypeORM для работы с базой данных SQLite.

## Что было сделано

### 1. Установлены зависимости
- `typeorm` - основной ORM
- `reflect-metadata` - для поддержки декораторов
- `sqlite3` - драйвер для SQLite
- `tsx` - для выполнения TypeScript скриптов

### 2. Создана конфигурация TypeORM
- `src/config/database.ts` - настройка подключения к базе данных
- Поддержка SQLite с автоматической синхронизацией схемы

### 3. Созданы Entity модели
- `src/entities/Student.ts` - модель студента с связью к группе
- `src/entities/Group.ts` - модель группы с обратной связью к студентам

### 4. Созданы сервисы
- `src/services/StudentService.ts` - сервис для работы со студентами и группами
- Методы CRUD операций для обеих сущностей

### 5. Обновлены API роуты
- `src/app/api/students/route.ts` - GET и POST для студентов
- `src/app/api/students/[id]/route.ts` - DELETE для студентов
- `src/app/api/groups/route.ts` - GET для групп

### 6. Обновлены типы
- Добавлена поддержка связей между сущностями в интерфейсах
- Обновлены TypeScript интерфейсы для соответствия Entity моделям

## Использование

### Инициализация базы данных
```bash
npm run init-db
```

### Запуск приложения
```bash
npm run dev
```

## Структура базы данных

### Таблица `student`
- `id` (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- `first_name` (TEXT, nullable)
- `last_name` (TEXT, nullable)
- `middle_name` (TEXT, nullable)
- `groupId` (INTEGER, nullable) - внешний ключ к таблице class

### Таблица `class`
- `id` (INTEGER, PRIMARY KEY, AUTOINCREMENT)
- `name` (TEXT)

## Особенности реализации

1. **Автоматическая инициализация**: База данных инициализируется автоматически при первом API запросе
2. **Связи между сущностями**: Student связан с Group через ManyToOne связь
3. **Типобезопасность**: Все операции с базой данных типизированы
4. **Обработка ошибок**: Добавлена обработка ошибок во всех API роутах

## Миграции

TypeORM настроен с `synchronize: true` для автоматического создания/обновления схемы базы данных. В продакшене рекомендуется использовать миграции вместо автоматической синхронизации.

## Дальнейшие улучшения

1. Добавить миграции для продакшена
2. Добавить валидацию данных на уровне Entity
3. Добавить индексы для оптимизации запросов
4. Добавить логирование запросов в продакшене
5. Добавить поддержку транзакций для сложных операций





